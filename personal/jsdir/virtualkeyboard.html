var alphaArray=new Array("q","w","e","r","t","y","u","i","o","p","a","s","d","f","g","h","j","k","l","z","x","c","v","b","n","m");var numArray=new Array("7","8","9","4","5","6","1","2","3","0");var SpCharArray=new Array("!","@","#","$","%","&","*","(",")","+","=","?",".");var currSpArray=new Array();var currAlphaArray=new Array();var currNumArray=new Array();var currControlArray=new Array();var randomAlpha=chooseNum(26,alphaArray);var randomNum=chooseNum(10,numArray);var randomSpChar=chooseNum(13,SpCharArray);var finalAlphaImage=new Array();var finalNumImage=new Array();var finalSpCharImage=new Array();var caps=0;var entry_field="fldPasswordVirtual";var form_name="frmmain";var textValue="";var isUpper=false;var timeoutObj;var selectedObj;var isRandom=true;var isMouseClicked=false;var isProcessing=false;var HOVER_TIMEOUT=2000;function setKeyboardFocus(p_formname,p_fieldname){form_name=p_formname;entry_field=p_fieldname;}function capsLock(q,fldItem){var l_obj;l_obj=document.getElementById(fldItem);if(q==0){caps=1;l_obj.style.background="#000080";}else{caps=0;l_obj.style.background="#EFEFEF";}}function showValue(p_obj){if(isProcessing){return false;}str=document.forms[form_name].elements[entry_field].value;var l_tmp=p_obj.value;if(p_obj.value=="&"){l_tmp="&";}document.forms[form_name].elements[entry_field].value=str+l_tmp;document.forms[form_name].elements[entry_field].focus();if(isRandom){doRandomize();}return false;}function chooseNum(nums,numArr){if(nums>numArr.length){return false;}var chooseArr=new Array();var tempArr=new Array();for(var l_i=0;l_i<numArr.length;l_i++){tempArr[l_i]=numArr[l_i];}for(var i=0;i<nums;i++){chooseArr[chooseArr.length]=tempArr[Math.round((tempArr.length-1)*Math.random())];var temp=chooseArr[chooseArr.length-1];for(var j=0;j<tempArr.length;j++){if(tempArr[j]==temp){tempArr[j]=null;var tempArr2=new Array();for(var k=0;k<tempArr.length;k++){if(tempArr[k]!=null){tempArr2[tempArr2.length]=tempArr[k];}}tempArr=tempArr2;break;}}}return chooseArr;}function imageAlphaOnPage(p_i){for(var n=0;n<randomAlpha.length+1;n++){finalAlphaImage[n]=randomAlpha[p_i];}document.write('<input type="button" class="virtualButtons" value="'+finalAlphaImage[p_i]+'" id="elemA'+p_i+'" onmouseover="startHover(this);" onmousedown="return changeToStar();" onmouseup="return changeBack();" onmouseout="return changeBack(),stopHover();" OnClick="return showValue(this);">');document.write("</input>");}function imageNumOnPage(p_i){for(var n=0;n<randomNum.length+1;n++){finalNumImage[n]=randomNum[p_i];}document.write('<input type="button" class="virtualButtons" value="'+finalNumImage[p_i]+'" id="elemN'+p_i+'" onmouseover="startHover(this);" onmousedown="return changeToStar();" onmouseup="return changeBack();" onmouseout="return changeBack(),stopHover();" OnClick="return showValue(this);" >');document.write("</input>");}function imageSpCharOnPage(p_i){for(var n=0;n<randomSpChar.length+1;n++){finalSpCharImage[n]=randomSpChar[p_i];}document.write('<input type="button" class="virtualButtons" value="'+finalSpCharImage[p_i]+'" id="elemS'+p_i+'" onmouseover="startHover(this);" onmousedown="return changeToStar();" onmouseup="return changeBack();" onmouseout="return changeBack(),stopHover();" OnClick="return showValue(this);" >');document.write("</input>");}function disableKeyBoard(e){if(window.event){if(event.keyCode){event.returnValue=false;event.keyCode=0;}}else{if(navigator.appName=="Netscape"){e.preventDefault();}}return false;}function changeToStar(){if(isProcessing){return false;}for(var l_i=0;l_i<SpCharArray.length;l_i++){currSpArray[l_i]=document.getElementById("elemS"+l_i).value;document.getElementById("elemS"+l_i).value="*";}for(var l_i=0;l_i<alphaArray.length;l_i++){currAlphaArray[l_i]=document.getElementById("elemA"+l_i).value;document.getElementById("elemA"+l_i).value="*";}for(var l_i=0;l_i<numArray.length;l_i++){currNumArray[l_i]=document.getElementById("elemN"+l_i).value;document.getElementById("elemN"+l_i).value="*";}for(var l_i=0;l_i<4;l_i++){currControlArray[l_i]=document.getElementById("elemC"+l_i).value;document.getElementById("elemC"+l_i).value="*";}isMouseClicked=true;return false;}function changeBack(){if(!isMouseClicked){return false;}for(var l_i=0;l_i<SpCharArray.length;l_i++){document.getElementById("elemS"+l_i).value=currSpArray[l_i];}for(var l_i=0;l_i<alphaArray.length;l_i++){if(isUpper){document.getElementById("elemA"+l_i).value=currAlphaArray[l_i].toUpperCase();}else{document.getElementById("elemA"+l_i).value=currAlphaArray[l_i].toLowerCase();}}for(var l_i=0;l_i<numArray.length;l_i++){document.getElementById("elemN"+l_i).value=currNumArray[l_i];}for(var l_i=0;l_i<4;l_i++){document.getElementById("elemC"+l_i).value=currControlArray[l_i];}isMouseClicked=false;isProcessing=false;return false;}function setRandom(){if(isRandom){isRandom=false;document.getElementById("elemC3").value="Mixed";}else{isRandom=true;document.getElementById("elemC3").value="Not Mixed";}doRandomize();return false;}function doRandomize(){var l_sArray;var l_aArray;var l_nArray;if(!isRandom){l_aArray=alphaArray;l_nArray=numArray;l_sArray=SpCharArray;}else{l_aArray=chooseNum(26,alphaArray);l_nArray=chooseNum(10,numArray);l_sArray=chooseNum(13,SpCharArray);}for(var l_i=0;l_i<l_sArray.length;l_i++){if(l_sArray[l_i]=="&"){document.getElementById("elemS"+l_i).value="&";}else{document.getElementById("elemS"+l_i).value=l_sArray[l_i];}}for(var l_i=0;l_i<l_aArray.length;l_i++){if(isUpper){document.getElementById("elemA"+l_i).value=l_aArray[l_i].toUpperCase();}else{document.getElementById("elemA"+l_i).value=l_aArray[l_i].toLowerCase();}}for(var l_i=0;l_i<l_nArray.length;l_i++){document.getElementById("elemN"+l_i).value=l_nArray[l_i];}return false;}function setCase(){if(isUpper){isUpper=false;document.getElementById("elemC0").value="Upper";}else{isUpper=true;document.getElementById("elemC0").value="Lower";}changeCase();}function changeCase(){var l_aArray;if(!isRandom){l_aArray=alphaArray;}else{l_aArray=chooseNum(26,alphaArray);}for(var l_i=0;l_i<l_aArray.length;l_i++){if(isUpper){document.getElementById("elemA"+l_i).value=l_aArray[l_i].toUpperCase();}else{document.getElementById("elemA"+l_i).value=l_aArray[l_i].toLowerCase();}}return false;}function startHover(p_obj){if(document.getElementById("elemC4").checked){if(timeoutObj!=null){clearTimeout(timeoutObj);}selectedObj=p_obj;timeoutObj=setTimeout("showVal()",HOVER_TIMEOUT);}}function stopHover(){if(document.getElementById("elemC4").checked){clearTimeout(timeoutObj);timeoutObj=null;changeBack();}}function showVal(){if(isMouseClicked){return false;}showValue(selectedObj);changeToStar();selectedObj=null;isProcessing=true;setTimeout("stopHover()",500);}